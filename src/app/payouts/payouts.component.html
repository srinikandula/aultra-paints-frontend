<!--  Error Toast (floating) -->
<div *ngIf="showToast" class="custom-toast">
  {{ toastMessage }}
</div>

<div class="container-fluid container-mt shadow-sm">
  <!-- Payouts Header Section -->
  <div class="row mb-4 align-items-center justify-content-between">
    <!-- Left: Page Title -->
    <div class="col-md-6">
      <h4 class="mb-0 fw-semibold">Payouts</h4>
    </div>

    <!-- Right: Available Balance + Export Button -->
    <div class="col-md-6 d-flex justify-content-end align-items-center flex-wrap gap-3">
      
      <!--  Available Balance box (before Export button) -->
      <div class="balance-box px-4 py-2 rounded shadow-sm">
        <strong class="balance-label">Available Balance:</strong>
        <span class="balance-amount">â‚¹{{ availableBalance | number:'1.2-2' }}</span>
      </div>

      <!--  Export Button -->
      <button class="btn btn-success btn-sm d-flex align-items-center" (click)="exportToExcel()">
        <img src="\assets\Download_icon.png" alt="Download"
             style="width: 20px; margin-right: 5px; filter: invert(1);" />
        Export
      </button>
    </div>
  </div>
</div>


<div class="table-wrapper">
  <table class="table table-hover">
    <thead class="thead-dark">
      <tr>
        <th scope="col">S.NO</th>
        <th scope="col">Transfer ID</th>
        <th scope="col">Status</th>
        <th scope="col">Status Code</th>
        <th scope="col">Transfer Mode</th>
        <th scope="col">Transfer Amount</th>
        <th scope="col">Added On</th>
        <th scope="col">Updated On</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let transaction of cashFreeTransactions; let i = index">
        <td>{{ (currentPage - 1) * limit + i + 1 }}</td>
        <td>{{ transaction.transfer_id }}</td>
        <td>{{ transaction.status }}</td>
        <td>{{ transaction.status_code }}</td>
        <td>{{ transaction.transfer_mode }}</td>
        <td>{{ transaction.transfer_amount }}</td>
        <td>{{ transaction.added_on | date: 'short' }}</td>
        <td>{{ transaction.updated_on | date: 'short' }}</td>
      </tr>
      <tr *ngIf="cashFreeTransactions.length === 0">
        <td class="text-center" colspan="9">No Records found</td>
      </tr>
    </tbody>
  </table>
</div>
  
  <!-- Pagination Controls -->
  <div class="row">
    <div class="col-sm-12 text-right">
      <div class="d-flex justify-content-end">
        <!-- Page Size Selector -->
        <select [(ngModel)]="limit" (change)="handleLimitChange()" class="form-select mx-2" style="width:100px; margin-bottom: 16px;">
          <option *ngFor="let limitOption of limitOptions" [value]="limitOption">{{ limitOption }}</option>
        </select>
  
        <!-- Pagination Controls -->
        <ngb-pagination class="mx-2"
                        [(page)]="currentPage"
                        [pageSize]="limit"
                        [collectionSize]="totalTransactions"
                        [boundaryLinks]="true"
                        (pageChange)="handlePageChange($event)"
                        [maxSize]="5">
        </ngb-pagination>
      </div>
    </div>
  </div>